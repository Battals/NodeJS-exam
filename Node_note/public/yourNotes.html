<!DOCTYPE html>
<html>

<head>
  <title>MyNote</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">MyNote</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/register">Register</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/login">Login</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" onclick="logOut()" href="/logout">Logout</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container">

    <h1 class="my-4">Add a Note</h1>

    <div class="form-group">
      <label for="title">Title</label>
      <input type="text" class="form-control" id="title" aria-describedby="titleHelp" placeholder="Enter email">
      <div id="titleHelp" class="form-text">Add a title</div>
    </div>
    <div class="form-group">
      <label for="desc">Description</label>
      <textarea type="text" class="form-control" id="desc" placeholder="Description"></textarea>
    </div>
    <button type="submit" onclick="onAddNote()" class="btn btn-primary">Submit</button>


    <h1 class="my-4">Your Notes</h1>
    <div class="mynotes row">

      <div id="noteContainer" class="mynotes row"></div>

    </div>

  </div>

  </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous">
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
  fetchNotes();
});

    function logOut() {
      localStorage.clear();
    }
    function onAddNote() {
      const title = document.getElementById("title").value;
      const desc = document.getElementById("desc").value;

      fetch("/auth/notes/add", {
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        method: "POST",
        body: JSON.stringify({
          email: localStorage.getItem("email"),
          titel: title,
          description: desc
        })

      })
      alert("Note created!")
    }
    function fetchNotes() {
      fetch('/auth/notes/get', {
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        method: 'POST',
        body: JSON.stringify({ email: localStorage.getItem('email') })
      })
        .then(response => response.json())
        .then(data => {
          const noteContainer = document.getElementById('noteContainer');
          data.forEach(note => {
            const card = document.createElement('div');
            card.classList.add('card', 'mx-2');
            card.style.width = '18rem';

            const cardBody = document.createElement('div');
            cardBody.classList.add('card-body');

            const title = document.createElement('h5');
            title.classList.add('card-title');
            title.textContent = note.title;

            const subtitle = document.createElement('h6');
            subtitle.classList.add('card-subtitle', 'mb-2', 'text-muted');
            subtitle.textContent = note.subtitle;

            const content = document.createElement('p');
            content.classList.add('card-text');
            content.textContent = note.content;

            const description = document.createElement('p');
            description.classList.add('card-text');
            description.textContent = note.description;

            const link1 = document.createElement('a');
            link1.classList.add('card-link');
            link1.href = '#';
            link1.textContent = 'Card link';


            cardBody.appendChild(title);
            cardBody.appendChild(subtitle);
            cardBody.appendChild(content);
            cardBody.appendChild(description);
            cardBody.appendChild(link1);

            card.appendChild(cardBody);
            noteContainer.appendChild(card);
          });
        })
        .catch(error => {
          console.log(error);
        });

    }



  </script>


</body>

</html>